\documentclass[rinkou,a4paper,uplatex]{ieicej}
\usepackage{graphicx}
\usepackage{url}
\usepackage{paralist}

\usepackage{ascmac}
\usepackage{fancybox}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsfonts}
\usepackage{pifont}
\usepackage{multirow}
\usepackage{comment}
\usepackage{amsmath} % 数学記号のサポート
\usepackage{amsfonts} % 数学フォント
\usepackage{mathrsfs} % \mathscr を使用するため
\usepackage{diagbox}%表
\usepackage{array} % 追加する必要があります
\usepackage{tabularx} % 必ず使用する必要があります
\usepackage{float}

\usepackage{mathtools}%絶対値
\DeclarePairedDelimiter{\abs}{\lvert}{\rvert}


% UserSetting
\newenvironment{narrow}{\baselineskip=3mm}

\setcounter{page}{1}
\vol{107}%year
\no{11}%month
\day{29}%day

\jtitle{他ユーザの転送レートへの影響を考慮した画質レート制御関数の提案}%title
\jsubtitle
\authorlist{
 \authorentry{菊地 悠李}{Yuri KIKUCHI}{}
} \vspace{-3mm}
\begin{document}

\maketitle
\section{はじめに}
本輪講では，研究内容の整理と進捗について報告することを目的とする．

\section{研究概要}
近年，ストリーミングサービスの普及と需要の増加に伴い，ネットワークトラフィックが増加し，インターネットトラフィックの中で動画が大きな割合を占めている．このトラフィックの増加により，安定して高画質な動画を配信することが重要な課題となっている．そこで，動的に変動する限られたネットワーク帯域幅の中で，サーバとユーザ間で動画データを適応的に送信する技術として，アダプティブビットレートストリーミング（ABS）が活用されている．しかし，このABSではユーザ同士の画質要求がリンクの帯域利用効率に影響を与えるという課題がある．この問題を解決するために，ユーザの画質レートを制御し，安定して高画質な動画配信を実現する画質レート制御の研究が進められている．

特に，複数のユーザが共有するリンクがボトルネックとなる場合，リンクの帯域幅が逼迫し，あるユーザの要求する画質レートが他のユーザの使用帯域幅に影響を与える．結果として，共有しているユーザは希望する画質データが十分に送信されない，あるいは動画の再生が停止することがある．このような課題を解決するためには，ユーザ間の相互影響を考慮した適切な画質レート制御が必要である．

本研究では，ユーザの要求画質レートが他のユーザの帯域使用に及ぼす相互依存関係を，ゲーム理論を用いてモデル化する．ゲーム理論は，複数のユーザが共有資源を取り合う際に生じる相互依存関係を数理モデルを通じて解析する理論である．本研究では，このゲーム理論を基盤に，ユーザの戦略に応じてユーザ毎に異なるペナルティを導入し，ユーザの要求画質レートが他のユーザの帯域使用に及ぼす影響を考慮した新たな利得関数を提案する．

%%リンク共有時の動画再生停止を防ぐための既存の画質レート制御関数では，自身の要求画質による他ユーザの転送レートへの影響が考慮されていない．そこで本研究では，このような他ユーザの転送レートへの影響を考慮した画質レート制御関数を提案する．

\section{関連研究}
本節では，これまでのレート制御に関する研究を紹介し，それぞれの問題点について述べる．

これまでのレート制御に関する研究では，画質やバッファの枯渇率，連続再生時間などを考慮して動画再生停止が起きないように画質レートを制御する手法が提案されていた．しかし，このような手法ではユーザ個人ごとに制御を行っているため，原因となっているユーザ間の相互影響を考慮できていない．

文献\cite{kison}と\cite{motomoto}は，複数のユーザがリンクを共有する状況をゲーム理論を用いて考慮したレート制御手法を提案している．これらの手法は，共有リンクの帯域幅を共有資源として複数のユーザが帯域を取り合う状況をゲーム理論でモデル化し，利得関数を用いてユーザ毎に最適な画質レートを決定している．
しかし，各ユーザの選択画質レートが他ユーザの帯域への影響を十分に反映できていない．


\section{想定システム}
本稿では，図１に示すような複数ユーザが利用するリンクに対してボトルネックリンクが存在する環境を仮定する．
\begin{figure}[hh]
\centering
\includegraphics[scale=0.25]{seminar-material/platex/souteisisutemu.eps}
\caption{想定システム}\label{tsubame}
\end{figure}
ボトルネックリンクの環境では，リンクの帯域幅が狭まっており，ユーザの要求画質が共有しているその他ユーザの使用するはずの帯域に大きく影響し，使用できる帯域を狭め，影響を受けたユーザが動画の再生停止に陥りやすくなる問題がある．そこで，本研究では各ユーザの要求画質によるその他ユーザの使用帯域への影響を考慮するために，ゲーム理論を用いてこの問題をモデル化する．

ゲーム理論では，相手のとる戦略を考慮しながら自身の利益が最大となる戦略をとる数理モデルを解析する．このゲーム理論を用いたレート制御を行うことでユーザ間の相互影響における動画の再生停止に陥りやすくなる問題を考慮し，解決する．その際，帯域を狭めている各ユーザの要求画質の大きさを考慮せずに，画質レート制御を行うと，帯域にあまり影響を及ぼしていない低い画質レートを要求しているユーザにまで，制御がかかってしまう．本来は高画質レートを要求するユーザのわがままによって，帯域幅をより狭め，リンクを共有するその他ユーザが影響を受けて動画の再生停止になる．よって，この問題を解決する制御になっていない．

そのため，各ユーザが要求する画質レートが，どれだけその他ユーザの使用帯域を狭めているかを考慮し，その影響度の大きさに応じてペナルティを与えることで，リンクを共有しているユーザの要求の相互影響を考慮した画質レート制御を実現する．

\begin{figure}[hh]
\centering
\includegraphics[scale=0.25]{syorinagare.eps}
\caption{処理の流れ}\label{tsubame}
\end{figure}

処理の流れは，図2に示す\cite{motomoto}．
まず初めに，ユーザはサーバにセグメント単位で，動画の画質レートを要求する．次に，要求された画質レートと帯域幅の大きさを考慮して，利得関数を用いて最適画質レートを導出する．その後，決定した画質レートのデータをユーザに送信する流れである．本研究では，この流れの利得関数に着目して提案を行う．

\section{提案画質レート制御法}

%%下の説明をどこに入れるか
本稿では，ユーザ$i$の最適画質レート$r_i^*$を決定するため，非協力ゲームを用いて，各ユーザが自身の戦略である画質レートを変更してもこれ以上利益が増えない状態である最適応答となる戦略画質の組み合わせ（以降，ナッシュ均衡点と呼ぶ）を求める．ゲーム理論を用いると，$N=${$1,2,3,\dots,n$}，ユーザの選択可能画質$r_i$，ユーザ$i$の利得関数を$f_i$とすると，$G=\left(N,{r_i}_{(i\in N)},{f_i}_{(i\in N)}\right)$とモデル化することができる．
本研究では，ナッシュ均衡点を利得関数によって決定する．

本研究では，先行研究\cite{kison}と\cite{motomoto}で用いられている利得関数を基に，関数の一部を変更したものであるため，まずは先行研究での利得関数について説明を行う．

\subsection{先行研究の利得関数}
以下に先行研究の利得関数を示す．
\begin{equation}
 f_{i}=\underbrace{t_{i}q_{i}(r_{i,k})}_{(\rm{A})}+\underbrace{\mu\Delta{b^{\rm{est}}_{i,k}}(r_{i,k},\mathbf{r}_{-i,k})}_{(\rm{B})}+\underbrace{\gamma_i{R}_{\rm{f}}(r_{i,k})}_{(\rm{C})}.
\end{equation}
先行研究では，数式(1)を用いて最適レートを導出していた．
(A)項は画質レートのみから得られる嬉しさを表す単調増加の関数である．
(B)項はバッファの変動量を用いてユーザの画質レートを制御する関数である．
(C)項は前のセグメントで決定した画質レートとの変動差を抑える関数である．
ここで，大きく画質レートの制御を行っているのは，(B)項であった．
次に，(B)項を説明する．以下に，(B)項を示す．
\begin{equation}
 f_i=Tr_i-Tr_i(\frac{\sum^N_{i=1}r_i}{B})
\end{equation}

式(2)は，あるセグメントにおけるバッファの変動量を表している．
$T$はセグメント長[s]，$r_i$は画質レート[Mbps]，$B$はリンクの全帯域幅[Mbps]を表す．
１項目はバッファにたまるのデータ量を表し，２項目は１項目のデータがバッファにたまり切るまでの時間でバッファから消費されるデータ量を表す．

ここで，２項目の()内は要求に対するペナルティを表している．全帯域に対して全ユーザの合計要求画質レートの方が大きいと，要求画質レートのデータがバッファにダウンロードされるまでに時間がかかり，その間，よりバッファからデータが消費される．バッファにデータがたまっていない状態をバッファ枯渇と言い，再生できる動画データがないため，動画の再生停止が起きる．

このペナルティ関数では，ユーザ毎の要求画質レートの大きさに応じてペナルティを与えていない．そのため，帯域を狭めている大きい画質レートを要求したユーザも，小さい画質を要求したユーザも同じペナルティが与えられ，制限がかけられる．それは，以下の表1を見れば明らかである．
%%以下101行目の１文修正箇所

\begin{table}[h]
    \centering
    \caption{既存研究の利得表（一部抜粋）}
    \scalebox{0.8}{
    \begin{tabular}{|c|c|}
        \hline
        (ユーザ1, ユーザ2) & 1 \\ \hline
        1 & (0.5, 0.5) \\ \hline
        2 & (0.5, 0.25) \\ \hline
        3 & (0.0, 0.0) \\ \hline
        4 & (-1.0, -0.25) \\ \hline
        5 & (-2.5, -0.5) \\ \hline
        6 & (-4.5, -0.75) \\ \hline
    \end{tabular}
    }
\end{table}


表1は数式(2)より，二人のユーザがそれぞれの画質レートを要求したときに得られる利得を表している．縦軸のユーザ1のみが6Mbps，横軸のユーザ2が1Mbpsをとった時のそれぞれの利得は，わがままな要求をしているユーザ1のみだけでなく，低画質レートを要求しているユーザ２にもペナルティがかかり，ユーザ2の利得も同時に下がっている．

そのため，本研究ではユーザの要求画質と他ユーザへの影響度合いを考慮したペナルティ関数に変更する．

\subsection{提案する利得関数}
次に提案する利得関数について説明する．
以下に利得関数の式を示す．
\begin{equation}
 f_i=Tr_i-Tr_i(\frac{r_i}{B(1-\frac{r_i}{\sum^N_{i=1}r_i})})
\end{equation}

上式は，あるセグメントにおけるバッファの変動量を表している．
$T$はセグメント長[s]，$r_i$は画質レート[Mbps]，$B$はリンクの全帯域幅[Mbps]を表す．
\begin{equation}
    \frac{r_i}{B(1-\frac{r_i}{\sum^N_{i=1}r_i})}
\end{equation}
数式(4)が本研究で変更するペナルティ関数である．まず，分母について説明する．
\begin{equation}
   B\frac{r_i}{\sum^N_{i=1}r_i}
\end{equation}
数式(5)はユーザ$i$の全帯域$B$において使用可能帯域を表している．各ユーザの要求画質レートの割合に基づいて全帯域$B$を分配して求めている\cite{johari}．分母全体は全帯域$B$からユーザ$i$の使用可能帯域を引いているため，他ユーザの合計の使用可能帯域を表している．よってペナルティ関数全体は，自身の要求画質レートが，その他ユーザの使用可能帯域にどれだけ影響するかでペナルティを与えることを表している．

$r_i$のみを大きくすると数式(5)が増加し，ペナルティ関数の分母が減少し，ユーザ$i$のペナルティのみが増加する．しかし，ユーザ$i$以外も同時に要求画質レートをレート増加させると，使用帯域は要求の比率によって決定されるため，全帯域$B$をユーザ数で均等割りした値になり，全ユーザ同じペナルティが与えられる．つまり，ユーザ$i$のみがわがままな要求であった場合，ユーザ$i$のみにペナルティが与えられる．

\section{数値計算}
本解析では，ユーザ数$N=2$，セグメント長$T=1$[s]，全帯域幅$B = 4$[Mbps] ，ユーザが選択できる画質レート$r_i$は(1,2,3,4,5,6)[Mbps]とした場合を想定した．

表2は，今回提案する利得関数の数式(3)によって得られた利得表である．
表3は，先行研究の利得関数である数式(2)によって得られた利得表である．

縦軸はユーザ1の選択画質レート，横軸はユーザ2の選択画質レートであり，その内側は(ユーザ1の利得，ユーザ2の利得)を表わしている．

\newpage
\begin{table}[h]
    \centering
    \caption{新規関数の利得表}
    \scalebox{0.58}{
    \begin{tabular}{|c|c|c|c|c|c|c|}
        \hline
        (ユーザ1, ユーザ2) & 1 & 2 & 3 & 4 & 5 & 6 \\ \hline
        1 & (0.5, 0.5) & (0.62, -1.0) & (0.67, -6.0) & (0.69, -16.0) & (0.7, -32.5) & (0.71, -57.0) \\ \hline
        2 & (-1.0, 0.62) & (0.0, 0.0) & (0.33, -2.62) & (0.5, -8.0) & (0.6, -16.88) & (0.67, -30.0) \\ \hline
        3 & (-6.0, 0.67) & (-2.62, 0.33) & (-1.5, -1.5) & (-0.94, -5.33) & (-0.6, -11.67) & (-0.37, -21.0) \\ \hline
        4 & (-16.0, 0.69) & (-8.0, 0.5) & (-5.33, -0.94) & (-4.0, -4.0) & (-3.2, -9.06) & (-2.67, -16.5) \\ \hline
        5 & (-32.5, 0.7) & (-16.88, 0.6) & (-11.67, -0.6) & (-9.06, -3.2) & (-7.5, -7.5) & (-6.46, -13.8) \\ \hline
        6 & (-57.0, 0.71) & (-30.0, 0.67) & (-21.0, -0.37) & (-16.5, -2.67) & (-13.8, -6.46) & (-12.0, -12.0) \\ \hline
    \end{tabular}
    }
\end{table}


\begin{table}[h]
    \centering
    \caption{既存研究の利得表}
    \scalebox{0.6}{
    \begin{tabular}{|c|c|c|c|c|c|c|}
        \hline
        (ユーザ1, ユーザ2) & 1 & 2 & 3 & 4 & 5 & 6 \\ \hline
        1 & (0.5, 0.5) & (0.25, 0.5) & (0.0, 0.0) & (-0.25, -1.0) & (-0.5, -2.5) & (-0.75, -4.5) \\ \hline
        2 & (0.5, 0.25) & (0.0, 0.0) & (-0.5, -0.75) & (-1.0, -2.0) & (-1.5, -3.75) & (-2.0, -6.0) \\ \hline
        3 & (0.0, 0.0) & (-0.75, -0.5) & (-1.5, -1.0) & (-2.25, -3.0) & (-3.0, -5.0) & (-3.75, -7.5) \\ \hline
        4 & (-1.0, -0.25) & (-2.0, -1.0) & (-3.0, -2.25) & (-4.0, -4.0) & (-5.0, -6.25) & (-6.0, -9.0) \\ \hline
        5 & (-2.5, -0.5) & (-3.75, -1.5) & (-5.0, -3.0) & (-6.25, -5.0) & (-7.5, -7.5) & (-8.75, -10.5) \\ \hline
        6 & (-4.5, -0.75) & (-6.0, -2.0) & (-7.5, -3.75) & (-9.0, -6.0) & (-10.5, -8.75) & (-12.0, -12.0) \\ \hline
    \end{tabular}
    }
\end{table}

表2では，片方のユーザのみが選択画質を大きくすることで，そのユーザにのみ大きくペナルティがかかり，利得が大きく低くなる．

既存研究の利得表である表3から，要求が低いユーザに対してもペナルティが作用しているため，適切な制御ではないことが分かる．
これは，数式(2)の第2項分数部分のペナルティ関数から，どのユーザに対しても同様のペナルティの値を掛けることから分かる．対して，今回提案する利得関数では，自身の要求画質レートと他ユーザの使用帯域への影響度合いによって各ユーザに異なるペナルティを与えるペナルティ関数となっている．


\section{終わりに}
本稿では，自身の要求画質レートが他ユーザの使用帯域への影響を考慮した画質レート制御関数を示した．

今後の課題として，結果としてナッシュ均衡点の画質の組み合わせが先行研究より悪いものになっており，分かりやすい評価軸がないため，このペナルティ関数がどのような場合で，評価できるかを考える．
また，ある瞬間の利得表によるものであるため，図２の処理の流れのように，次のセグメントでの影響がまだ評価しきれていないため，今後考慮していく．
ペナルティについても，システム的な意味やゲーム理論としてのペナルティのような数式になっているかを精査しきれていないため，文献\cite{sigmund2010}などを参考にしながら，考えていく．


\section{これまでの質問}

\begin{itemize}
    \item
    もともとのバッファの変動量はどう求めていたのか
    
    ・$Tr_i-Tr_i(\frac{r_i}{B_i})$，バッファにたまるデータ量ーバッファから消費されるデータ量で表している．ここで，$B_i$はユーザ$i$が使用できる帯域幅(転送レート)を表わしている．
    
    数式()内は自身の転送レートに対する要求画質レートの大きさによって，要求した画質データが送信されるのに何倍の時間がかかるかを表わすシステムペナルティとしていた．しかし，ユーザ毎に$B_i$を正確に測定するのは難しいため，先行研究では全帯域を用いて，全ユーザの合計要求レートから平均的なペナルティを導出している．

    \item
    先行研究のバッファ変動を考慮した式についてゲーム性がない

    ・先行研究のバッファ変動を考慮した式2の問題点は，各ユーザの転送レートと要求を全体的な帯域幅の平均化を行い，ユーザの要求度に応じてペナルティの変化がなくゲーム性を薄めている点．これを解決するため，他ユーザの転送レートに対してどれだけ大きい画質レートを要求しているかを表す（式４）に置き換えた．

    \item   
    セグメント単位(s)とダウンロード時間で式2の理解が複雑になっている．単位時間でそろえた方が良いのではないか．
    
    ・ストリーミングにおけるレート制御であるため，最終的にはセグメント単位で考える必要がある．
    ただ，現在は理解しやすいようにセグメント長$T$を1とし，単位時間ごとにゲームをしていることにしている．セグメント単位と時間の違いとして，セグメントは動画データを2秒単位で区切って送信する2秒をセグメントという．ダウンロード時間はその２秒分の視聴できる動画データをバッファ内にダウンロードするまでにかかった時間を表わしている．

    \item   
    先行研究のペナルティはゲーム性はないが，システム的な正しさはあるペナルティである気がする．それに対して今回のペナルティはシステム的な正しさはあるのか．

    ・システム的な正しさを持つペナルティとしてまでは，考え切れていない

    
    \item   
    ペナルティによる下限はどこまでか決めているのか．また，ユーザ側のメリットは何．

    ・現在，ペナルティ自体に下限は決めていない．ユーザ側のメリットとしては，わがままな要求をしていないユーザが不当に利得を減少されないであるが，それによって現在画質レートは上がっていないため，今後，前のセグメントでのペナルティが次のセグメントでの画質レート選択に影響を及ぼすようにしていきたい．

    


\end{itemize}


\begin{table}[H]
    \caption{変数の説明.}
    \centering
    \scalebox{0.75}{
        \begin{tabular}{c||c}
            \hline \hline
             変数 & 意味  \\
            \hline \hline
            $N$ & ユーザ数  \\ \hline
            $f_i$ & 画質レートを選択する利得関数  \\ \hline
            $i$ & i番目のユーザ  \\ \hline
            $r_i$ & i番目のユーザの要求画質レート  \\ \hline
            $T$ & セグメント長  \\ \hline
            $B$ & サーバーの全帯域幅\\ \hline
            \hline
        \end{tabular}
    }
    \label{MMSSpara}
\end{table}


\bibliography{refs}
\bibliographystyle{ieeetr}
\end{document}
